<!--


    Copyright 2009-2012 Jayway Products AB

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<div class="content-primary" role="main">

  <!-- Single issue -->
  <div class="single-issue">

    <!-- Issue header -->
    <div class="m-h cf">
      <div class="id">{{case[0].caseId}}</div>
      <div class="choose-type">
        <i class="icon-search"></i>
        <label class="struct" for="issue-type">Ärendetyp</label>
        <input type="text" name="issue-type" id="issue-type" placeholder="Välj ärendetyp">
      </div>
      <a href="xlink-" class="wiki-link">
        <i class="icon-info"></i><span class="struct">Namn på ärendetyp</span>
      </a>
      <a href="xlink-" class="edit-module icon-edit" title="Redigera ärende">
        <span class="struct">Redigera ärende</span>
      </a>
    </div>
    <!-- /Issue header -->

    <!-- Issue body -->
    <div class="issue-body">
      <div class="due-date {{case.index.overdueStatus()}}">
        <span>{{case[0].overdueDays() | positive}}</span>
      </div>
      <div class="issue-description">
        <h2>{{case[0].text}}</h2>
        <p>{{notes[0]}}</p>
      </div>
    </div>
    <!-- /Issue body -->

    <!-- Issue notes -->
    <!--
    <div class="issue-notes cf">

      <div class="notes-content">

        <form action="#" method="get" class="input-note cf">
          <div class="text">
            <label for="note-text" class="struct">Notering</label>
            <input type="text" name="note-text" id="note-text" placeholder="Notering">
          </div>
          <div class="submit-area">
            <button type="submit" name="add-note">Lägg till</button>
          </div>
        </form>

        <div class="posted-notes">
          <div class="note-item cf">
            <div class="note-body">
              <p>Det här ser ut som ett intressant ärende! Jag tar det!</p>
            </div>
            <div class="note-posted-by">
              <span class="struct">Postad av: </span>Solveig Grankvist
              <span class="note-timestamp">2 dagar sedan</span>
            </div>
          </div>
          <div class="note-item cf">
            <div class="note-body">
              <p>Vi borde byta färg på alla soptunnor till rosa, eller vad säger ni? Då kanske gräsklippningen inte blir så lidande. Låter långsökt, jag vet. Men det är värt ett försök!</p>
            </div>
            <div class="note-posted-by">
              <span class="struct">Postad av: </span>Johannes Pettersson-Jansson
              <span class="note-timestamp">4 dagar sedan</span>
            </div>
          </div>
          <div class="note-item cf">
            <div class="note-body">
              <p>Jag kollade upp detta och det finns inte ens något gräs i parken!</p>
            </div>
            <div class="note-posted-by">
              <span class="struct">Postad av: </span>Ola Persson
              <span class="note-timestamp">5 dagar sedan</span>
            </div>
          </div>
          <div class="expandable-field">
            <div class="expandable-content">

              <div class="note-item cf">
                <div class="note-body">
                  <p>Ok, fine!</p>
                </div>
                <div class="note-posted-by">
                  <span class="struct">Postad av: </span>Sonja Eriksson
                  <span class="note-timestamp">8 dagar sedan</span>
                </div>
              </div>
              <div class="note-item cf">
                <div class="note-body">
                  <p>Du fixar väl det?</p>
                </div>
                <div class="note-posted-by">
                  <span class="struct">Postad av: </span>Erik Johansson
                  <span class="note-timestamp">8 dagar sedan</span>
                </div>
              </div>
              <div class="note-item cf">
                <div class="note-body">
                  <p>Någon som vill ta detta?</p>
                </div>
                <div class="note-posted-by">
                  <span class="struct">Postad av: </span>Sonja Eriksson
                  <span class="note-timestamp">8 dagar sedan</span>
                </div>
              </div>

            </div>
          </div>
        </div>

      </div>

    </div>
    -->
    <!-- /Issue notes -->

  </div>
  <!-- /Single issue -->

  <!-- Module: Check list -->
  <!--
  <div class="m m-check-list">
    <div class="m-h">
      <h2>Checklista</h2>
      <a href="xlink-" class="add-item">Lägg till <i class="icon-plus"></i></a>
    </div>
    <div class="mc">
      <form action="#" method="get">
        <ul class="check-list zebra-list">
          <li class="odd">
          <div class="checkbox">
            <input type="checkbox" name="check1-1" id="check1-1" />
            <label for="check1-1">Skolplats ansökningsformulär ifyllt</label>
          </div>
          </li>
          <li>
          <div class="checkbox">
            <input type="checkbox" name="check1-2" id="check1-2" />
            <label for="check1-2">Skolplats ansökningsformulär ifyllt</label>
          </div>
          </li>
          <li class="odd">
          <div class="checkbox">
            <input type="checkbox" name="check1-3" id="check1-3" />
            <label for="check1-3">Skolplats ansökningsformulär ifyllt</label>
          </div>
          </li>
        </ul>
      </form>
    </div>
  </div>
  -->
  <!-- /Check list -->

  <!-- Issue forms -->
  <div class="m m-issue-forms">
    <div class="m-h">
      <h2>Formulär</h2>
      <div class="m-c">
          <ul class="form-tabs cf">
            <li class="has-versions" ng-repeat="possibleForm in possibleForms">
               <!-- TODO selected element -->
               <a href="" ng-click="selectForm( possibleForm.href )" class="sel">{{ possibleForm.text }}</a>
               <a href="xlink-" class="icon-arrow-down versions-drop"><span class="struct">Visa tidigare versioner</span></a>
            </li>
          </ul>
          <ol class="form-sections cf">
              <li class="section-item" ng-class="{sel: currentFormPage.title==page.title}" ng-repeat="page in form[0].pages"><a href="" ng-click="selectFormPage(page)">{{page.title}}</a></li>
          </ol>

          <form method="post" novalidate ng-submit="submitForm()">
              <div>{{ formMessage }}</div>
              <div ng-repeat="field in currentFormPage.fields" class="row cols-1 cf">
                  <div class="form-row" data-ng-switch on="field.field.fieldValue._type">

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.TextFieldValue">
                        <div class="text col full col-1">
                          <label for="{{ field.field.fieldId }}">{{ field.field.description }}
                          <span><em ng-show="field.field.fieldValue.hint">({{ field.field.fieldValue.hint }})</em><span ng-show="field.field.mandatory">*</span></span></label>
                          <input maxlength="{{ field.field.fieldValue.width }}" ng-required="field.field.mandatory" ng-pattern="field.field.fieldValue.regularExpression" type="text" ng-model="field.value" name="{{ field.field.fieldId }}" id="{{ field.field.field }}" sf-on-blur="saveForm(field.field.field, $event)">
                          <span class="error-ng-invalid-required" style="display: none">Required!</span>
                          <span class="error-ng-invalid-pattern" style="display: none">Invalid input format</span>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.DateFieldValue">
                        <div class="text col full col-1">
                          <label for="{{ field.field.fieldId }}">{{ field.field.description }}
                          <span><em ng-show="field.field.fieldValue.hint">({{ field.field.fieldValue.hint }})</em><span ng-show="field.field.mandatory">*</span></span></label>
                          <input maxlength="{{ field.field.fieldValue.width }}" ng-required="field.field.mandatory" type="date" ng-model="field.value" name="{{ field.field.fieldId }}" id="{{ field.field.field }}" sf-on-blur="saveForm(field.field.field, $event)">
                          <span class="error-ng-invalid-required" style="display: none">Required!</span>
                          <span class="error-ng-invalid-pattern" style="display: none">Invalid input format</span>
                        </div>
                      </div>



                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.NumberFieldValue">
                        <div class="text col full col-1">
                          <label for="{{ field.field.fieldId }}">{{ field.field.description }}
                          <span><em ng-show="field.field.fieldValue.hint">({{ field.field.fieldValue.hint }})</em><span ng-show="field.field.mandatory">*</span></span></label>
                          <input ng-required="field.field.mandatory" ng-pattern="field.field.fieldValue.regularExpression" type="text" ng-model="field.value" name="{{ field.field.fieldId }}" id="{{ field.field.field }}" sf-on-blur="saveForm(field.field.field, $event)">
                          <span class="error-ng-invalid-required" style="display: none">Required!</span>
                          <span class="error-ng-invalid-pattern" style="display: none">Invalid number format</span>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.TextAreaFieldValue">
                        <div class="text col full col-1">
                            <label for="{{ field.field.fieldId }}">{{ field.field.description }}
                            <span><em ng-show="field.field.fieldValue.hint">({{ field.field.fieldValue.hint }})</em><span ng-show="field.field.mandatory">*</span></span></label>
                            <textarea name="{{ field.field.fieldId }}" id="{{ field.field.field }}" cols="{{ field.field.fieldValue.cols }}" rows="{{ field.field.fieldValue.rows }}" sf-on-blur="saveForm(field.field.field, $event)">{{ field.value }}</textarea>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.ComboBoxFieldValue">
                        <div class="select col medium col-2">
                            <label for="{{ field.field.fieldId }}">{{ field.field.description }}</label>
                            <select custom-select ng-model="field.value"
                                    ng-options="option.value as option.name for option in field.field.fieldValue.options" sf-on-blur="saveForm(field.field.field, $event)">
                            </select>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.ListBoxFieldValue">
                        <div class="select col medium col-2">
                            <label for="{{ field.field.fieldId }}">{{ field.field.description }}</label>
                            <select multiple ng-multiple="true" ng-model="field.value"
                                    ng-options="option.value as option.name for option in field.field.fieldValue.options" sf-multiple-select-auto-send name="{{ field.field.field }}">
                            </select>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.OptionButtonsFieldValue">
                        <div class="radio col medium col-2">
                            <label for="{{ field.field.fieldId }}">{{ field.field.description }}</label>
                            <span ng-repeat="option in field.field.fieldValue.values">
                              <input ng-change="inputChanged({fieldId: field.field.field, value: field.value})" ng-model="field.value" type="radio" name="{{ field.field.fieldId }}" value="{{ option }}" sf-on-blur="saveForm(field.field.field, $event)">{{ option }}</input>
                            </span>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.OpenSelectionFieldValue">
                        <div class="radio col medium col-2">
                            <label for="{{ field.field.fieldId }}">{{ field.field.description }}</label>
                            <span ng-repeat="option in field.field.fieldValue.extendedValues">
                              <input sf-radio-extended-auto-send="{{ option.value != option.display }}" ng-model="field.value" type="radio" name="{{ field.field.fieldId }}"
                              id="{{ field.field.field }}" value="{{ option.value }}">{{ option.display }}</input>
                            </span>
                            <div ng-show="field.field.fieldValue.values.indexOf(field.value) == -1"><input ng-model="field.value" sf-radio-extended-text-field="{{ field.field.fieldValue.extendedValues }}" type="text" name="{{ field.field.field }}"></div>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.CheckboxesFieldValue">
                        <div class="radio col medium col-2">
                            <label for="{{ field.field.fieldId }}">{{ field.field.description }}</label>
                            <span ng-repeat="option in field.field.fieldValue.checkings">
                              <input type="checkbox" sf-checkbox-auto-send="{{field.field.fieldValue.checkings}}"  value="{{option.name}}" ng-model="option.checked" type="radio" name="{{ field.field.field }}">{{ option.name }}</input>
                            </span>
                        </div>
                      </div>

                      <div data-ng-switch-when="se.streamsource.streamflow.api.administration.form.CommentFieldValue">
                        <div class="col medium col-2" ng-bind-html-unsafe="field.field.note"></div>
                      </div>

                      <div data-ng-switch-default>
                        <div class="text col full col-1">
                            <b>{{ field.field.description }}</b><br />
                            Not supported form type <i>{{ field.field.fieldValue._type }}</i>
                        </div>
                      </div>
                  </div>

              </div>


              <div ng-show="isLastPage(currentFormPage)">
                <input type="submit" name="submit" value="Skicka"></input>
              </div>
              <!--
              <div class="row cols-1 cf">
                  <div class="text col full col-1">
                      <label for="field-2">Personnummer <em>ååååmmdd-xxxx</em></label>
                      <input type="text" name="field-2" id="field-2">
                  </div>
              </div>
              <div class="row cols-1 cf">
                  <div class="text col full col-1">
                      <label for="field-3">Namn <em>Vårdnadshavare</em></label>
                      <input type="text" name="field-3" id="field-3">
                  </div>
              </div>
              <div class="row cols-1 cf">
                  <div class="text col full col-1">
                      <label for="field-4">Gatuadress</label>
                      <input type="text" name="field-4" id="field-4">
                  </div>
              </div>
              <div class="row cols-2 cf">
                  <div class="text col small col-1">
                      <label for="field-5">Postnummer</label>
                      <input type="text" name="field-5" id="field-5" />
                  </div>
                  <div class="text col large col-2">
                      <label for="field-6">Postort</label>
                      <input type="text" name="field-6" id="field-6" />
                  </div>
              </div>
              <div class="row cols-1 cf">
                  <div class="text col full col-1">
                      <label for="field-7">Telefon</label>
                      <input type="text" name="field-7" id="field-7">
                  </div>
              </div>
              <div class="row cols-1 cf">
                  <div class="text col full col-1">
                      <label for="field-8">E-post</label>
                      <input type="text" name="field-8" id="field-8">
                  </div>
              </div>-->
          </form>

          <div ng-show="currentFormPage">
            <a href="" class="btn inline" ng-class="{inactive: isFirstPage()}" ng-click="!isFirstPage() && previousFormPage()">Tillbaka</a> <a href="" class="btn inline" ng-class="{inactive: isLastPage()}" ng-click="!isLastPage() && nextFormPage()">Nästa</a>
          </div>

      </div>
    </div>
  </div>
  <!-- /Issue forms -->

</div>
<!-- /Content primary -->

<!-- Content secondary -->
<div class="content-secondary" role="complementary">

  <h2 class="struct">Verktyg och annan information</h2>

  <!-- Issue toolbar -->
  <div class="toolbar">
    <a href="#" class="btn">Byt ägare</a>
    <a href="#" class="btn">Tilldela</a>
    <a href="#" class="btn">Stäng</a>
    <a href="#" class="btn dropdown">Mer</a>
  </div>
  <!-- /Issue toolbar -->

  <!-- Module: Allmänt -->
  <div class="m m-general">
    <div class="m-h">
      <h2>Allmänt</h2>
    </div>
    <div class="m-c">
      <div class="m-box">
        <ul>
          <li><strong>Ägare:</strong> {{ case[0].owner }}</li>
          <li><strong>Handläggare:</strong> {{ case[0].assignedTo }}</li>
          <li ng-show="general[0].priority.text"><strong>Prioritet:</strong> {{ general[0].priority.text }}</li>
          <li><strong>Kund:</strong> TODO TODOsson 19760901-4046</li>
          <li ng-show="general[0].dueOn"><strong>Förfallodatum:</strong> {{ general[0].dueOn | longDate }}</li>
        </ul>
      </div>
    </div>
  </div>
  <!-- /Module: Allmänt -->

  <!-- Module: Konversationer -->
  <div class="m m-convos">
    <div class="m-h">
      <h2>Konversationer</h2>
    </div>
    <div class="m-c">
      <ul>
        <li ng-repeat='conversation in conversations'>
          <a href="#" class="block-link">
          <h3>{{ conversation.text }}</h3>
          <span class="date">{{ conversation.creationDate | dateTime }}</span>
          <ul class="convo-status">
            <li class="icon-user" title="{{ conversation.participants }} användare i konversationen">{{ conversation.participants }} <span class="struct">användare i konversationen</span></li>
            <li class="icon-chat" title="{{ conversation.messages }} meddelanden i konversationen">{{ conversation.messages }} <span class="struct">meddelanden i konversationen</span></li>
          </ul>
        </a>
        </li>
      </ul>
    </div>
  </div>
  <!-- /Module: Konversationer -->

  <!-- Module: Kontakter -->
  <div class="m m-contacts">
    <div class="m-h">
      <h2>Kontakter</h2>
    </div>
    <div class="m-c">
      <ul class="zebra-list">
        <li ng-repeat='contact in contacts'>
        <a href="{{contact.view-href}}">{{contact.name}}</a>
        </li>
      </ul>
    </div>
  </div>
  <!-- /Module: Kontakter -->

  <!-- Module: Bifogade filer -->
  <div class="m m-attachments">
    <div class="m-h">
      <h2>Bifogade filer</h2>
    </div>
    <div class="m-c">
      <ul class="zebra-list">
        <li class="odd">
        <a href="xlink-">Karta</a>
        <a href="#" class="delete" title="Radera fil">Radera fil</a>
        </li>
        <li>
        <a href="xlink-">Foto på gräsmattan</a>
        <a href="#" class="delete" title="Radera fil">Radera fil</a>
        </li>
        <li class="odd">
        <a href="xlink-">Ett foto till på gräsmattan</a>
        <a href="#" class="delete" title="Radera fil">Radera fil</a>
        </li>
      </ul>
    </div>
  </div>
  <!-- /Module: Bifogade filer -->

  <!-- Module: Ärendelogg -->
  <div class="m m-issuelog">
    <div class="m-h">
      <h2>Ärendelogg</h2>
    </div>
    <div class="m-c">
      <table class="log-table">
        <caption class="struct">Historik för detta ärende</caption>
        <thead class="struct">
          <tr>
            <th>Datum</th>
            <th>Titel</th>
            <th>Användare</th>
          </tr>
        </thead>
        <tbody>
        <tr>
          <td>1 juli</td>
          <td>Öppna ärende</td>
          <td>Henrik Reinhold</td>
        </tr>
        <tr class="even">
          <td>15 juni</td>
          <td>Tilldela ärende</td>
          <td>Solveig Grankvist</td>
        </tr>
        <tr>
          <td>13 juni</td>
          <td>Tilldela ärende</td>
          <td>Henrik Reinhold</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  <!-- /Module: Ärendelogg -->
<!-- <pre><code>{{ form[0] | json }}</code></pre> -->
</div>
<!-- /Content secondary -->

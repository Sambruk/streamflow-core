Scenario: User changes password
Given basic user setup
Given user named user1
When user changes password from password1 to newPassword
Then events changedPassword occurred
And exception is not thrown

Scenario: User changes password with too short password
Given basic user setup
Given user named user1
When user changes password from password1 to new
Then ConstraintViolationException is thrown
And no events occurred

Scenario: User changes password with too long password
Given basic user setup
Given user named user1
When user changes password from password1 to ThisPasswordIsAwfullyLongAndContains
Then ConstraintViolationException is thrown
And no events occurred

Scenario: User changes password with specialCharacters
Given basic user setup
Given user named user1
When user changes password from password1 to ÅÄÖåäö9999?!_-
Then exception is not thrown
And events changedPassword occurred

Scenario: User tries to change password but get exception
Given basic user setup
Given user named user2
When user changes password from wrongPassword to newPassword
Then WrongPasswordException is thrown
And no events occurred

Scenario: User logs in
Given basic user setup
Given user named user1
When user tries to login with password password1
Then no events occurred

Scenario: User logs in with wrong password
Given basic user setup
Given user named user1
When user tries to login with password wrongPassword
Then events failedLogin occurred
And exception is not thrown

Scenario: User is disabled
Given basic user setup
Given user named user1
When user enabled is set to false
Then events changedEnabled occurred
And exception is not thrown

Scenario: Enabled user is enabled
Given basic user setup
Given user named user1
When user enabled is set to true
Then no events occurred

Scenario: Disabled user is enabled
Given basic user setup
Given user named disabledUser
When user enabled is set to true
Then events changedEnabled occurred
And exception is not thrown

Scenario: Disabled user is disabled
Given basic user setup
Given user named disabledUser
When user enabled is set to false
Then no events occurred

Scenario: User reset password
Given basic user setup
Given user named user1
When user resets password with newPassword
Then events changedPassword occurred






